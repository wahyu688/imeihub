server {
    listen 80;
    server_name localhost; # Ganti dengan domain Anda jika sudah punya

    root /usr/share/nginx/html;
    index index.html index.htm;

    location / {
        try_files $uri $uri/ /index.html;
    }

    # Proxy requests to the backend API
    location /api/ {
        # GANTI DENGAN URL PUBLIK BACKEND ANDA
        proxy_pass https://admin.imeihub.id; # CONTOH: https://your-backend-app.dokploy.com
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_set_header X-Forwarded-Proto $scheme;
    }

    # Proxy requests to the Discord bot's API (for new order notifications)
    # Catatan: Jika bot di-deploy terpisah, ini mungkin tidak diperlukan
    # atau harus menunjuk ke URL publik bot (yang tidak disarankan untuk internal API)
    # Lebih baik backend utama langsung memanggil bot tanpa proxy dari frontend.
    # Jika Anda benar-benar mendeploy frontend, backend, dan bot sebagai 3 aplikasi TERPISAH
    # di Dokploy, maka komunikasi antara backend dan bot tidak perlu lewat Nginx frontend.
    # Hapus bagian ini di frontend Nginx jika backend langsung memanggil bot.
    # Kalaupun ada, harusnya proxy_pass ke URL PUBLIK bot.
    /* location /api/discord-bot-notify {
         proxy_pass https://your-discord-bot-app.dokploy.com/api/discord-bot-notify; // CONTOH
         proxy_set_header Host $host;
         proxy_set_header X-Real-IP $remote_addr;
         proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
         proxy_set_header X-Forwarded-Proto $scheme;
     } */

    # Optional: Proxy to Discord Bot commands (if directly exposing bot's command API)
    # location /discord-commands {
    #     proxy_pass http://discord_bot:3001;
    #     proxy_set_header Host $host;
    #     proxy_set_header X-Real-IP $remote_addr;
    #     proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
    #     proxy_set_header X-Forwarded-Proto $scheme;
    # }

    error_page 404 /404.html; # Opsional
    location = /40x.html {
    }

    error_page 500 502 503 504 /50x.html; # Opsional
    location = /50x.html {
    }
}