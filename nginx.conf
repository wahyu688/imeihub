server {
    listen 80;
    server_name localhost; # Ganti dengan domain Anda jika sudah punya

    root /usr/share/nginx/html;
    index index.html index.htm;

    location / {
        try_files $uri $uri/ /index.html;
    }

    # Proxy requests ke backend API (Misal: /api/register, /api/login, /api/order, /api/orders/:userId)
    location /api/ {
        # Pastikan ini adalah URL publik dari deployment backend utama Anda.
        # Jika backend Anda di-host di https://admin.imeihub.id, maka gunakan itu.
        proxy_pass https://admin.imeihub.id;
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_set_header X-Forwarded-Proto $scheme;
    }

    # Bagian ini dihapus karena komunikasi backend ke Discord bot tidak perlu melewati frontend Nginx.
    # Backend utama Anda akan langsung memanggil API bot Discord.
    # location /api/discord-bot-notify {
    #    proxy_pass https://your-discord-bot-app.dokploy.com/api/discord-bot-notify;
    #    proxy_set_header Host $host;
    #    proxy_set_header X-Real-IP $remote_addr;
    #    proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
    #    proxy_set_header X-Forwarded-Proto $scheme;
    # }

    # Optional: Proxy to Discord Bot commands (jika Anda ingin frontend mengakses endpoint bot secara langsung)
    # Ini tidak diperlukan jika bot hanya dipanggil oleh backend.
    # location /discord-commands {
    #     proxy_pass http://discord_bot:3001; # Ini untuk komunikasi antar kontainer, bukan publik
    #     proxy_set_header Host $host;
    #     proxy_set_header X-Real-IP $remote_addr;
    #     proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
    #     proxy_set_header X-Forwarded-Proto $scheme;
    # }

    error_page 404 /404.html; # Opsional
    location = /40x.html {
    }

    error_page 500 502 503 504 /50x.html; # Opsional
    location = /50x.html {
    }
}