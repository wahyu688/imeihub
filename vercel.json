{
  "version": 2,
  "builds": [
    {
      "src": "public_html/**",
      "use": "@vercel/static-build",
      "config": {
        "outputDirectory": "public_html"
      }
    },
    {
      "src": "backend/server.js",
      "use": "@vercel/node",
      "config": { "includeFiles": ["backend/.env", "backend/package.json", "backend/package-lock.json"] }
    },
    {
      "src": "discord_bot/bot.js",
      "use": "@vercel/node",
      "config": { "includeFiles": ["discord_bot/.env", "discord_bot/package.json", "discord_bot/package-lock.json"] }
    }
  ],
  "routes": [
    {
      "src": "/api/(.*)",
      "dest": "backend/server.js"
    },
    {
      "src": "/discord-bot-notify",
      "dest": "discord_bot/bot.js"
    },
    {
      "src": "/(.*)",
      "dest": "public_html/$1"
    }
  ],
  "env": {
    "PORT": "3000",
    "JWT_SECRET": "@jwt_secret",
    "DISCORD_BOT_UPDATE_API_URL": "@discord_bot_api_url",
    "DISCORD_ORDER_NOTIFICATION_CHANNEL_ID": "@discord_order_notification_channel_id",
    "ADMIN_DISCORD_USER_ID": "@admin_discord_user_id",
    "DISCORD_BOT_TOKEN": "@discord_bot_token",
    "DISCORD_BOT_API_PORT": "3001",
    "ADMIN_DISCORD_ROLE_ID": "@admin_discord_role_id"
  }
}